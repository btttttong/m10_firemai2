INSERT INTO `hs-new-project-456106.Firemai.fire_hotspot_main` (
  hotspot_id,
  v_angle,
  utm_e,
  track,
  th_date,
  changwat,
  bright_t31,
  tb_idn,
  tb_code,
  ap_tn,
  scan,
  pv_en,
  tambon_t,
  amphoe,
  longitude,
  tambol,
  pv_code,
  moo_1,
  acq_time,
  lu_hp,
  utm_zone,
  re_royin,
  tb_en,
  linkgmap,
  latitude,
  v_direct,
  ap_idn,
  instrument,
  _updatedBy,
  frp,
  amphoe_t,
  f_alarm,
  lu_name,
  acq_date,
  ap_code,
  ct_tn,
  satellite,
  re_nesdb,
  brightness,
  lu_hp_name,
  _createdBy,
  name_1,
  ap_en,
  _updatedAt,
  pv_idn,
  th_time,
  lu_code,
  hotspotid,
  pv_tn,
  _collectionId,
  province_t,
  v_dist,
  ct_en,
  tb_tn,
  confidence,
  _id,
  _createdAt
)
SELECT
  TO_HEX(MD5(CONCAT(CAST(acq_date AS STRING), CAST(latitude AS STRING), CAST(longitude AS STRING)))) AS hotspot_id,
  v_angle,
  utm_e,
  track,
  th_date,
  changwat,
  bright_t31,
  tb_idn,
  tb_code,
  ap_tn,
  scan,
  pv_en,
  tambon_t,
  amphoe,
  longitude,
  tambol,
  pv_code,
  moo_1,
  acq_time,
  lu_hp,
  utm_zone,
  re_royin,
  tb_en,
  linkgmap,
  latitude,
  v_direct,
  ap_idn,
  instrument,
  _updatedBy,
  frp,
  amphoe_t,
  f_alarm,
  lu_name,
  acq_date,
  ap_code,
  ct_tn,
  satellite,
  re_nesdb,
  brightness,
  lu_hp_name,
  _createdBy,
  name_1,
  ap_en,
  _updatedAt,
  pv_idn,
  th_time,
  lu_code,
  hotspotid,
  pv_tn,
  _collectionId,
  province_t,
  v_dist,
  ct_en,
  tb_tn,
  confidence,
  _id,
  _createdAt
FROM `hs-new-project-456106.Firemai.fire_hotspot_temp` temp
WHERE NOT EXISTS (
  SELECT 1
  FROM `hs-new-project-456106.Firemai.fire_hotspot_main` main
  WHERE main.hotspot_id = TO_HEX(MD5(CONCAT(CAST(temp.acq_date AS STRING), CAST(temp.latitude AS STRING), CAST(temp.longitude AS STRING))))
)